<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.intelligent.bot.dao.UserDao">


    <select id="checkTempUser" resultType="com.intelligent.bot.model.User">
        select
            id,
            name,
            mobile,
            type,
            remaining_times
            from
            t_user
        where type = 2 and (ip_address = #{ipAddress} or browser_fingerprint = #{browserFingerprint}) and deleted = 0
        ORDER BY  browser_fingerprint
        limit 1
    </select>
    <select id="queryUserPage" resultType="com.intelligent.bot.model.res.sys.admin.UserQueryPageRes">
        SELECT
            id,
            `name`,
            mobile,
            last_login_time,
            type,
            remaining_times,
            from_user_name,
            is_event,
            email,
            browser_fingerprint,
            ip_address,
            avatar,
            create_time
        FROM
            t_user
        where deleted = 0
        <if test="req.name != null and req.name != ''">
            <bind name="name" value="'%'+req.name+'%'"/>
            and name like #{name}
        </if>
        <if test="req.mobile != null and req.mobile != ''">
            <bind name="mobile" value="'%'+req.mobile+'%'"/>
            and mobile like #{mobile}
        </if>
        order by id desc
    </select>
</mapper>
